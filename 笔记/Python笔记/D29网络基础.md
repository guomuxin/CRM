# D29网络基础

## 一、网络基础

- ip地址:用来在网络中标识一台电脑,在同一网络中是唯一的

- 每一个ip地址都包括两部分:网络号和主机号

- 主机号为0时,ip地址与网络号一样,主机号为255时为广播地址,所以这两个主机号我们不能使用

- ip地址的分类:

  - A类地址:1字节网络号+3字节主机号,网络地址最高位为"0",地址范围:1.0.0.1 - 126.255.255.254,可用A类网络共2^7-2 = 126个(01111111做为本地软件环回测试,00000000全零表示本网络,这两个不能使用),每个网络可容纳2^24-2 = 16777214个主机

  - B类地址:2字节网络号+2字节主机号,网络地址最高位为"10",地址范围:128.0.0.1 - 191.255.255.254,可用B类网络共2^14 = 16384个,每个网络可容纳2^16-2 = 65534个主机

  - C类地址:3字节网络号+1字节主机号,网络地址最高位为"110",地址范围:192.0.0.1 -223.255.255.254,可用B类网络共2^21 = 2097152个,每个网络可容纳2^8-2 = 254个主机

  - D类地址:第⼀个字节以“1110”开始，
    它是⼀个专⻔保留的地址。它并不指向特定的⽹络， ⽬前这⼀类地址被⽤在多点⼴播（一对多） 中多点⼴播地址⽤来⼀次寻址⼀组计算机 地址范围224.0.0.1-239.255.255.254

  - E类地址:以“1111”开始，为将来使⽤保留 E类地址保留，仅作实验和开发⽤ 

  - 私有ip:本地局域网上的ip,专门为组织机构内部使用,公网不能使用,范围:

    –10.0.0.0～10.255.255.255

    –172.16.0.0～172.31.255.255 

    –192.168.0.0～192.168.255.255 

    私有ip不能出现在公网上,来自于私有ip的流量全部都被阻止丢弃

  - 回路测试ip:127.0.0.1:–测试当前计算机的网络通信协议

    如： 127.0.0.1可以代表本机IP地址， ⽤ http://127.0.0.1 就可以测试本机中配置的Web服务器

    常用来ping 127.0.0.1来看本地ip/tcp正不正常，如能ping通即可正常使用

- 子网掩码:是我们测量两个IP是否属于同一个网段的工具

  - ⼦⽹掩码不能单独存在， 它必须结合IP地址⼀起使⽤

  - ⼦⽹掩码只有⼀个作⽤， 就是将某个IP地址划分成⽹络地址和主机地址两部分

  - ⼦⽹掩码的设定必须遵循⼀定的规则：
     与IP地址相同， ⼦⽹掩码的长度也是32位，
     左边是⽹络位， ⽤⼆进制数字“1”表示；
     右边是主机位， ⽤⼆进制数字“0”表示

    假设IP192.168.1.1”255.255.255.0”1”24IP240”8IP8

## 二、端口号

- 端口号:用来区分需要网络服务的进程
- 通过ip地址我们可以找到一台主机,但是具体是需要于哪个进程进行交互只靠ip就不能做到,这时就需要端口号来区分一台主机中的不同进程,所以具体要找到通信目标实际上是通过ip+端口号做到的
- 端口号范围是0-65535,其中0-1023是知名端口,其余为动态端口
- 知名端口:用来做固定的事情,例如,–80端⼝分配给HTTP服务（网站）,–21端⼝分配给FTP服务（文件下载）,这些端口号是不会被分配给我们自己的进程的
- 动态端口:1024-65535:不固定分配给某项服务或进程,而是当一个进程需要分配端口号时,向主机进行申请,主机从可用的端口号分配共其使用

## 三、协议

- 协议:约定好的规范
- 由于最早之前各个网络公司使用的协议不统一,就造成无法进行通信或传输的局面,为了能够将全世界不同类型的所有计算机都连接起来,就制定了"互联网协议簇"做为通用协议标准
- 互联网协议簇包括了上百种协议,最重要的两个就是TCP和IP,所以通常把互联网协议统称为TCP/IP协议
- 七层网络结构（TCP/IP协议簇层次划分）（:ISO(国际标准化组织)制定的详细,复杂,繁琐,精确的网络通信协议
  - 物理层
  - 数据链路层
  - 网络层:IP
  - 传输层:TCP/UDP
  - 会话层
  - 表示层
  - 应用层
- 由于七层结构实现难度过高,通常实际使用时按4层划分
  - 网络接口层(链路层):–对实际的网络媒体的管理，定义如何使用实际网络来传送数据（处理机械的、电气的和过程的接口）,由七层模型中的物理层和数据链路层构成
  - 网络层:负责提供基本的数据包传送功能，让每一块数据包都能够到达目的主机。网络层接收由更低层发来的数据包，并把该数据包发送到更高层，相反，IP层也把从TCP或UDP层接收来的数据包传送到更低层
  - 传输层:在此层中，它提供了节点间的数据传送服务，如传输控制协议（TCP）、用户数据报协议（UDP）等，这一层负责传送数据，并且确定数据已被送达并接收
  - 应用层:应用程序间沟通的层，不同的文件系统有不同的文件命名原则和不同的文本行表示方法等，不同的系统之间传输文件还有各种不兼容问题，这些都将由应用层来处理.由七层模型中的会话层,表示层,应用层构成

## 四、Socket(套接字)编程

- socket:套接字,通过网络完成进程间通信的方式(区别于一台计算机之间的进程通信),是传输层与应用层之间的抽象层

- 实现方式:发送消息时,每经过一层协议,就在报头加一层,接收消息时,再一层一层去掉

  ![1571651621495](.\D29网络基础.assets\1571651621495.png)

- Socket本质是编程接口(API),Socket是对TCP/IP协议的封装,只是一个接口而本身并不是协议,通过Socket才能使用TCP/IP协议簇,,HTTP是轿车，提供了封装或者显示数据的具体形式；Socket是发动机，提供了网络通信的能力
- 最重要的是，Socket是面向客户/服务器模型而设计的，针对客户和服务器程序提供不同的Socket系统调用
- 套接字之间的连接过程可以分为三个步骤：服务器监听，客户端请求，连接确认

## 五、UDP的套接字编程

- UDP协议的特点:无连接,不提供可靠传输,没有确认重发机制,速度快,常用于多点通信或实时的数据业务

- 使用Socket编程:

  ```
  from socket import *
  创建套接字对象:
  s = socket(AF_INET, SOCK_DGRAM)
  绑定ip地址和端口号:
  addr = ("", 8080)
  s.bind(addr)
  发送数据:
  s.sendto(字节形式数据,(目标ip,目标端口))
  接收数据:
  s.recvfrom(1024)
  ```

  - s = socket(AF_INET, SOCK_DGRAM):参数1是ip地址信息,AF_INET为ipv4,默认用此,参数2为传输层协议,UDP为:SOCK_DGRAM,TCP为:SOCK_STREAM.
  - s.sendto(字节形式数据,(目标ip,目标端口)):UDP中使用sendto发送数据,数据必须要经过encode
  - s.recvfrom(1024):UDP中使用recvfrom接收数据,接收的数据为十六进制形式,需要decode(),参数为一次能够接收的最大字节数,如果传输的数据大小超过此值,超过部分会被丢弃